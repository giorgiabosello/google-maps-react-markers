import {forwardRef,useRef,useState,useCallback,useEffect,useMemo,Children,isValidElement,cloneElement}from'react';import {createPortal}from'react-dom';import {jsx,jsxs,Fragment}from'react/jsx-runtime';var S={};function W(t){let r=document.querySelector(`script[src="${t}"]`),a=r==null?undefined:r.getAttribute("data-status");return {node:r,status:a}}function Y(t={src:"",attributes:{},callbacks:{onLoadCallback:()=>{},onErrorCallback:()=>{}},elementIdToAppend:""},r,a={removeOnUnmount:false,shouldPreventLoad:false}){let[l,s]=useState(()=>!t.src||a!=null&&a.shouldPreventLoad?"idle":typeof window>"u"?"loading":S[t.src]??"loading");return useEffect(()=>{var p,o,g;if(r){s(r);return}if(!(t!=null&&t.src)||a!=null&&a.shouldPreventLoad)return;let i=S[t.src];if(i==="ready"||i==="error"){s(i);return}let u=W(t.src),e=u.node;if(e){let c=u.status??i??"loading";switch(c){case "loading":case "ready":(o=t.callbacks)!=null&&o.onLoadCallback&&t.callbacks.onLoadCallback();break;case "error":(g=t.callbacks)!=null&&g.onErrorCallback&&t.callbacks.onErrorCallback();break;}s(c);}else {e=document.createElement("script"),e.src=t.src,e.async=true,e.setAttribute("data-status","loading"),t.attributes&&Object.entries(t.attributes).length>0&&Object.entries(t.attributes).map(([m,d])=>e==null?undefined:e.setAttribute(m,d)),t.elementIdToAppend&&document.getElementById(t.elementIdToAppend)?(p=document.getElementById(t.elementIdToAppend))==null||p.appendChild(e):document.body.appendChild(e);let c=m=>{let d=m.type==="load"?"ready":"error";e==null||e.setAttribute("data-status",d);};e.addEventListener("load",c),e.addEventListener("error",c);}let n=c=>{var d,b;let m=c.type==="load"?"ready":"error";c.type==="load"?(d=t.callbacks)!=null&&d.onLoadCallback&&t.callbacks.onLoadCallback():(b=t.callbacks)!=null&&b.onErrorCallback&&t.callbacks.onErrorCallback(),s(m),S[t.src]=m;};return e.addEventListener("load",n),e.addEventListener("error",n),()=>{e&&(e.removeEventListener("load",n),e.removeEventListener("error",n)),e&&(a!=null&&a.removeOnUnmount)&&e.remove();}},[t,r,l]),l}var H=Y;var O=({apiKey:t,libraries:r=[],loadScriptExternally:a=false,status:l="idle",externalApiParams:s,callback:i})=>{var n;typeof window<"u"&&(window.googleMapsCallback=i);let u=(n=new URLSearchParams(s))==null?undefined:n.toString(),e=t?{src:`https://maps.googleapis.com/maps/api/js?key=${t}&callback=googleMapsCallback&libraries=${r==null?undefined:r.join(",")}${u?`&${u}`:""}`,attributes:{id:"googleMapsApi"}}:{src:`https://maps.googleapis.com/maps/api/js?callback=googleMapsCallback&libraries=${r==null?undefined:r.join(",")}`,attributes:{id:"googleMapsApi"}};return H(e,a?l:undefined)};var T=(t,r,a=1e-6)=>{if(t.length&&r.length){for(let l=0;l!==t.length;++l)if(Math.abs(t[l]-r[l])>a)return  false;return  true}return  false};var _=(t,r)=>{let a=useRef(),l=a.current,s=r(l,t);return useEffect(()=>{s||(a.current=t);}),s?l:t},x=_;var k=t=>{try{return {lat:t==null?void 0:t.lat(),lng:t==null?void 0:t.lng()}}catch{return t}},K=({container:t,pane:r,position:a,maps:l,drag:s})=>{class i extends google.maps.OverlayView{onAdd=()=>{var p;let e=this;s!=null&&s.draggable&&(this.get("map").getDiv().addEventListener("mouseleave",()=>{google.maps.event.trigger(this.container,"mouseup");}),this.container.addEventListener("mousedown",o=>{var g,c;this.container.style.cursor="grabbing",(g=e.map)==null||g.set("draggable",false),e.set("origin",o),s.onDragStart(o,{latLng:k(this.position)}),e.moveHandler=(c=this.get("map"))==null?undefined:c.getDiv().addEventListener("mousemove",m=>{var M,f;let d=e.get("origin");if(!d)return;let b=d.clientX-m.clientX,y=d.clientY-m.clientY,v=(M=e.getProjection())==null?undefined:M.fromLatLngToDivPixel(e.position);if(!v)return;let E=(f=e.getProjection())==null?undefined:f.fromDivPixelToLatLng(new l.Point(v.x-b,v.y-y));e.set("position",E),e.set("origin",m),e.draw(),s.onDrag(m,{latLng:k(E)});});}),this.container.addEventListener("mouseup",o=>{var g;(g=e.map)==null||g.set("draggable",true),this.container.style.cursor="default",e.moveHandler&&(google.maps.event.removeListener(e.moveHandler),e.moveHandler=null),e.set("position",e.position),e.set("origin",undefined),e.draw(),s.onDragEnd(o,{latLng:k(e.position)});}));let n=(p=this.getPanes())==null?undefined:p[this.pane];n==null||n.classList.add("google-map-markers-overlay"),n==null||n.appendChild(this.container);};draw=()=>{if(!this.container)return;let e=this.getProjection(),n=e==null?undefined:e.fromLatLngToDivPixel(this.position),p={x:this.container.offsetWidth/2,y:this.container.offsetHeight/2};n&&(this.container.style.transform=`translate(${n.x-p.x}px, ${n.y-p.y}px)`);};onRemove=()=>{this.container.parentNode!==null&&(google.maps.event.clearInstanceListeners(this.container),this.container.parentNode.removeChild(this.container));};container;pane;position;map=this.getMap();moveHandler;constructor(e,n,p){super(),this.container=e,this.pane=n,this.position=p,this.moveHandler=null;}}return new i(t,r,a)},U=K;var ee=({pane:t="floatPane",position:r,map:a,maps:l,zIndex:s=0,children:i,drag:u})=>{let e=useMemo(()=>{let o=document.createElement("div");return o.style.position="absolute",o},[]),n=useMemo(()=>U({container:e,pane:t,position:r,maps:l,drag:u}),[e,u,l,t,r]),p=x(i==null?undefined:i.props,(o,g)=>o&&o.lat===g.lat&&o.lng===g.lng&&o.draggable===g.draggable);return useEffect(()=>!n.map&&a?(n==null||n.setMap(a),()=>{n==null||n.setMap(null);}):()=>{},[a,p]),useEffect(()=>{e.style.zIndex=`${s}`;},[s,e]),createPortal(i,e)},R=ee;var P=()=>{},ae=({children:t,map:r,maps:a})=>{let l=useMemo(()=>!r||!a?[]:Children.map(t,s=>{if(isValidElement(s)){let i={lat:s.props.lat,lng:s.props.lng},{zIndex:u,draggable:e=false,onDragStart:n=P,onDrag:p=P,onDragEnd:o=P}=s.props||{};return s=cloneElement(s,{...s.props,onDragStart:undefined,onDrag:undefined,onDragEnd:undefined}),jsx(R,{position:new a.LatLng(i.lat,i.lng),map:r,maps:a,zIndex:u,drag:{draggable:e,onDragStart:n,onDrag:p,onDragEnd:o},children:s})}return null}),[t,r,a]);return jsx("div",{children:l})},$=ae;function le({children:t=null,style:r={width:"100%",height:"100%",left:0,top:0,margin:0,padding:0,position:"absolute"},defaultCenter:a,defaultZoom:l,onGoogleApiLoaded:s,onChange:i,options:u={},events:e=[]}){let n=useRef(null),p=useRef([]),[o,g]=useState(),[c,m]=useState(),[d,b]=useState(false),y=useCallback(()=>{var v,E;try{if(!o)return;let M=o.getZoom()??l,f=o.getBounds(),F=[(v=o.getCenter())==null?void 0:v.lng(),(E=o.getCenter())==null?void 0:E.lat()],h=f==null?void 0:f.getNorthEast(),L=f==null?void 0:f.getSouthWest();if(!h||!L||!f)return;let D=[L.lng(),L.lat(),h.lng(),h.lat()];T(D,p.current)||(i&&i({zoom:M,center:F,bounds:f}),p.current=D);}catch(M){console.error(M);}},[o,i]);return useEffect(()=>{n.current&&!o&&(g(new google.maps.Map(n.current,{center:a,zoom:l,...u})),m(google.maps));},[a,l,o,n,u]),useEffect(()=>{o&&!d&&(typeof s=="function"&&c&&s({map:o,maps:c,ref:n.current}),b(true),google.maps.event.hasListeners(o,"idle")&&google.maps.event.clearListeners(o,"idle"),google.maps.event.addListener(o,"idle",y));},[d,o,s]),useEffect(()=>()=>{o&&google.maps.event.clearListeners(o,"idle");},[o]),jsxs(Fragment,{children:[jsx("div",{ref:n,style:r,className:"google-map",...e==null?undefined:e.reduce((v,{name:E,handler:M})=>(v[E]=M,v),{})}),t&&o&&c&&jsx($,{map:o,maps:c,children:t})]})}var q=le;var ue=forwardRef(({apiKey:t="",libraries:r=["places","geometry"],children:a=null,loadingContent:l="Google Maps is loading",idleContent:s="Google Maps is on idle",errorContent:i="Google Maps is on error",mapMinHeight:u="unset",containerProps:e={},loadScriptExternally:n=false,status:p="idle",scriptCallback:o=()=>{},externalApiParams:g={},...c},m)=>{let d={ready:jsx(q,{...c,children:a}),loading:l,idle:s,error:i},b=O({apiKey:t,libraries:r,loadScriptExternally:n,status:p,externalApiParams:g,callback:o});return jsx("div",{ref:m,style:{height:"100%",width:"100%",overflow:"hidden",position:"relative",minHeight:u},...e,children:d[b]||null})}),B=ue;var qe=B;
export{qe as default};